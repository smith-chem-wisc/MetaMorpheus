<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
  <!--Shorthand way of getting the install directory-->
  <?define GUI_TargetDir=$(var.GUI.TargetDir)?>
  <?define CMD_TargetDir=$(var.CMD.TargetDir)?>

  <!--Product compiles into an msi file. Only one can be present.-->
  <!--Version needs to be replaced automatically-->
  <Product Id="*" Name="MetaMorpheus" Language="1033" Version="!(bind.FileVersion.MetaMorpheusGUI.exe)" Manufacturer="Smith Group" UpgradeCode="438ad6ff-f027-423a-ab0b-c73384c0e2e5">
    <!--Properties about the package to be placed in the Summary Information Stream.-->
    <!--These are visible from COM through the IStream interface, and these properties can be seen on the package in Explorer.-->
    <Package Id="*" InstallerVersion="500" Compressed="yes" InstallScope="perMachine" Platform="x64" />
    <Icon Id="icon.ico" SourceFile="$(var.GUI.TargetDir)..\..\..\Icons\MMnice.ico"/>
    <Property Id="ARPPRODUCTICON" Value="icon.ico"/>
    <MajorUpgrade AllowSameVersionUpgrades="yes" Schedule="afterInstallValidate" DowngradeErrorMessage="A newer version of MetaMorpheus is already installed." />

    <Condition Message="This application is only supported on Windows 7 or higher.">
      <![CDATA[Installed OR (VersionNT >= 601)]]>
    </Condition>

    <Condition Message="This application requires 64-bit windows">
      <![CDATA[Installed OR VersionNT64]]>
    </Condition>
    <MediaTemplate EmbedCab="yes" />

    <!--A feature for the Feature table. Features are the smallest installable unit.-->
    <Feature Id="ProductFeature" Level="1">
      <!-- ComponentGroupRef creates a reference to a ComponentGroup in another Fragment-->
      <ComponentGroupRef Id="ExecutablesAndLibrariesComponentGroup" />
      <ComponentGroupRef Id="ExecutablesAndLibrariesComponentGroup2" />
      <!--ComponentRef creates a reference to a Component element in another Fragment-->
      <ComponentRef Id="MetaMorpheusProgramMenuFolderComponent" />

      <!--App Data Section-->
      <ComponentGroupRef Id="Appsrc_Mods_files" />
      <ComponentGroupRef Id="Appsrc_Data_files" />
      <ComponentGroupRef Id="Appsrc_Glycan_Mods_files" />
      <ComponentGroupRef Id="Appsrc_NGlycan_files" />
      <ComponentGroupRef Id="Appsrc_OGlycan_files" />
      <ComponentGroupRef Id="Appsrc_ProteolyticDigestion_files" />
      <ComponentGroupRef Id="Appsrc_Contaminants_files" />
      <ComponentGroupRef Id="ExcelDefaults" />
      <ComponentRef Id="RemoveApp" />
      <ComponentRef Id="DesktopShortcut" />
    </Feature>

    <Directory Id="TARGETDIR" Name="SourceDir">
      <!--Desktop Shortcut Installation-->
      <Directory Id="DesktopFolder" Name="Desktop">
        <Component Id="DesktopShortcut" Guid="ef1fd292-b162-4990-80cb-cd2a0c839d4b">
          <Condition>INSTALLDESKTOPSHORTCUT</Condition>
          <RegistryKey Root="HKCU" Key="Software\SmithGroup\MetaMorpheus">
            <RegistryValue Name="MetaMorpheusDeskTop" Value="1" Type="integer" KeyPath="yes" />
          </RegistryKey>
          <Shortcut Id="AppDeskTopSC" Name="MetaMorpheus" Description="Shortcut to App" Target="[#MetaMorpheusGUI.exe]" WorkingDirectory="MetaMorpheusInstallFolder" />
        </Component>
      </Directory>

      <Directory Id="ProgramFiles64Folder">
        <Directory Id="MetaMorpheusInstallFolder" Name="MetaMorpheus">
          <Directory Id="NativeMathDllFolder_runtimes" Name="runtimes">
            <Directory Id="NativeMathDllFolder_win_x64" Name="win-x64">
              <Directory Id="NativeMathDllFolder_native" Name="native">
              </Directory>
            </Directory>
          </Directory>
        </Directory>
      </Directory>
      <Directory Id="ProgramMenuFolder">
        <Directory Id="MetaMorpheusProgramMenuFolder" Name="MetaMorpheus" />
      </Directory>
      
      <!--These are the directories created in the local user app data folder-->
      <Directory Id="LocalAppDataFolder">
        <Directory Id="MetaMorpheusAppFolder" Name="MetaMorpheus">
          <Component Id="RemoveApp" Guid="a5443b89-65b0-4855-b521-e7bcc9c5a85c">
            <RemoveFolder Id="MetaMorpheusAppFolder" On="uninstall" />
            <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
          </Component>
          <Directory Id="MetaAppDataFolder" Name="Data" />
          
          <Directory Id="MetaAppModsFolder" Name="Mods">                                
          </Directory>
          
          <Directory Id ="MetaAppGlycan_ModsFolder" Name="Glycan_Mods">
            <!--NGlycan and OGlycan are sub folders of mods. Therefore they are placed inside the "Mods" Directory tags-->
            <Directory Id="MetaAppNGlycanFolder" Name="NGlycan" />
            <Directory Id="MetaAppOGlycanFolder" Name="OGlycan" />
          </Directory>
          
          <Directory Id="MetaAppProteolyticDigestionFolder" Name="ProteolyticDigestion" />
          <Directory Id="MetaAppContaminantsFolder" Name="Contaminants" />
        </Directory>
      </Directory>
      <!--End user local app data folders-->
    
    </Directory>

    <UI>
      <UIRef Id="WixUI_Mondo" />
      <UIRef Id="newDlg" />
      <UIRef Id="MyMaintenance" />
      <Publish Dialog="WelcomeDlg" Control="Next" Event="NewDialog" Value="MetaSCDlg" Order="1">1</Publish>
      <Publish Dialog="MetaSCDlg" Control="Back" Event="NewDialog" Value="WelcomeDlg" Order="1">1</Publish>
      <Publish Dialog="MetaSCDlg" Control="Next" Event="NewDialog" Value="VerifyReadyDlg" Order="1">1</Publish>
      <Publish Dialog="VerifyReadyDlg" Control="Back" Event="NewDialog" Value="MetaSCDlg" Order="1">1</Publish>
      <Publish Dialog="MaintenanceWelcomeDlg" Control="Next" Event="NewDialog" Value="MyMaintenanceTypeDlg">1</Publish>
      <Publish Dialog="MyMaintenanceTypeDlg" Control="Back" Event="NewDialog" Value="MaintenanceWelcomeDlg" Order="1">1</Publish>
      <!--<Publish Dialog="MyMaintenanceTypeDlg" Control="Next" Event="NewDialog" Value="ExitDialog" Order="1">1</Publish>-->
      <Publish Dialog="ExitDialog"
        Control="Finish"
        Event="DoAction"
        Value="LaunchApplication">WIXUI_EXITDIALOGOPTIONALCHECKBOX = 1 and NOT Installed</Publish>
    </UI>

    <CustomAction Id='LaunchFile' FileKey='MetaMorpheusGUI.exe' ExeCommand='' Return="asyncNoWait" />
    <Property Id="OVERWRITEAPPDATA" Value="1" />
    <Property Id="WIXUI_MONDO" Value="INSTALLFOLDER" />
    <Property Id="WIXUI_EXITDIALOGOPTIONALCHECKBOXTEXT" Value="Launch MetaMorpheus" />
    <Property Id="WixShellExecTarget" Value="[#MetaMorpheusGUI.exe]" />
    <Property Id="EXCELDEFAULTPROPERTY" />
    <Property Id="EXCELSELECT" Value="1">
      <RegistrySearch Id="CheckFileDir" Root="HKCR" Key="Excel.Backup\shell\Open\command" Type="file">
        <FileSearch Name="EXCEL.exe" />
      </RegistrySearch>
    </Property>
    <CustomAction Id="LaunchApplication" BinaryKey="WixCA" DllEntry="WixShellExec" Impersonate="yes" />
  </Product>

  <!--Executables and libraries-->
  <Fragment>
    <ComponentGroup Id="ExecutablesAndLibrariesComponentGroup" Directory="MetaMorpheusInstallFolder">
      <Component Id="MetaMorpheusGUI.exe" Guid="63370d96-1880-40ab-8525-685ccf64326f">
        <File Id="MetaMorpheusGUI.exe" Name="MetaMorpheusGUI.exe" Source="$(var.GUI_TargetDir)MetaMorpheusGUI.exe" />
      </Component>
      <Component Id="app.manifest" Guid="d894958a-07c1-4078-9e0e-081a6cc29030">
        <File Id="app.manifest" Name="app.manifest" Source="$(var.GUI_TargetDir)app.manifest" />
      </Component>
      <Component Id="src_TaskLayer.pdb" Guid="6ece566a-22ff-4208-bba2-ad0430eeee49">
        <File Id="src_TaskLayer.pdb" Name="TaskLayer.pdb" Source="$(var.GUI_TargetDir)TaskLayer.pdb" />
      </Component>
      <Component Id="src_Newtonsoft.Json.dll" Guid="7001FD86-E768-4C32-9747-0AB44A5A3DE9">
        <File Id="src_Newtonsoft.Json.dll" Name="Newtonsoft.Json.dll" Source="$(var.GUI_TargetDir)Newtonsoft.Json.dll" />
      </Component>
      <Component Id="src_UsefulProteomicsDatabases.dll" Guid="e7f76fbf-d21c-4e57-bed4-33f71822ee18">
        <File Id="src_UsefulProteomicsDatabases.dll" Name="UsefulProteomicsDatabases.dll" Source="$(var.GUI_TargetDir)UsefulProteomicsDatabases.dll" />
      </Component>
      <Component Id="src_TaskLayer.dll" Guid="7d468a75-d294-432e-bd59-8fcf1e254486">
        <File Id="src_TaskLayer.dll" Name="TaskLayer.dll" Source="$(var.GUI_TargetDir)TaskLayer.dll" />
      </Component>
      <Component Id="src_Chemistry.dll" Guid="bd4869a2-82a3-4d52-97b7-888881ae1827">
        <File Id="src_Chemistry.dll" Name="Chemistry.dll" Source="$(var.GUI_TargetDir)Chemistry.dll" />
      </Component>
      <Component Id="src_EngineLayer.dll" Guid="ebfe6a93-fdc4-4cff-a510-ff516e532d50">
        <File Id="src_EngineLayer.dll" Name="EngineLayer.dll" Source="$(var.GUI_TargetDir)EngineLayer.dll" />
      </Component>
      <Component Id="src_EngineLayer.pdb" Guid="8f9592a4-02b1-4462-a259-f7aa41d890a4">
        <File Id="src_EngineLayer.pdb" Name="EngineLayer.pdb" Source="$(var.GUI_TargetDir)EngineLayer.pdb" />
      </Component>
      <Component Id="src_FlashLFQ.dll" Guid="69e33379-5301-49db-8913-4d777ed5a5f9">
        <File Id="src_FlashLFQ.dll" Name="FlashLFQ.dll" Source="$(var.GUI_TargetDir)FlashLFQ.dll" />
      </Component>
      <Component Id="src_MassSpectrometry.dll" Guid="d6241678-3d48-4c7a-becf-9c1160fbe06b">
        <File Id="src_MassSpectrometry.dll" Name="MassSpectrometry.dll" Source="$(var.GUI_TargetDir)MassSpectrometry.dll" />
      </Component>
      <Component Id="src_MathNet.Numerics.dll" Guid="dea92905-719e-48e1-8a64-e845dca06dac">
        <File Id="src_MathNet.Numerics.dll" Name="MathNet.Numerics.dll" Source="$(var.GUI_TargetDir)MathNet.Numerics.dll" />
      </Component>
      <Component Id="src_MetaMorpheusGUI.pdb" Guid="bf568e2b-42c1-4209-9f45-11a3af86110a">
        <File Id="src_MetaMorpheusGUI.pdb" Name="MetaMorpheusGUI.pdb" Source="$(var.GUI_TargetDir)MetaMorpheusGUI.pdb" />
      </Component>
      <Component Id="src_mzIdentML.dll" Guid="cb1200d2-2356-4664-8968-bff79c83eeac">
        <File Id="src_mzIdentML.dll" Name="mzIdentML.dll" Source="$(var.GUI_TargetDir)mzIdentML.dll" />
      </Component>
      <Component Id="src_MzLibUtil.dll" Guid="9475fcb2-63bd-490c-8441-17a1760869ac">
        <File Id="src_MzLibUtil.dll" Name="MzLibUtil.dll" Source="$(var.GUI_TargetDir)MzLibUtil.dll" />
      </Component>
      <Component Id="src_MzML.dll" Guid="40c12490-638a-41b9-9e0c-05e949236a5a">
        <File Id="src_MzML.dll" Name="MzML.dll" Source="$(var.GUI_TargetDir)MzML.dll" />
      </Component>
      <Component Id="src_NetSerializer.dll" Guid="9eddc340-0dcb-415a-85f4-322f0eaeee4b">
        <File Id="src_NetSerializer.dll" Name="NetSerializer.dll" Source="$(var.GUI_TargetDir)NetSerializer.dll" />
      </Component>
      <Component Id="src_Nett.dll" Guid="656c78ef-0234-4e45-957c-a6dd6fff044f">
        <File Id="src_Nett.dll" Name="Nett.dll" Source="$(var.GUI_TargetDir)Nett.dll" />
      </Component>
      <Component Id="src_pepXML.dll" Guid="9a086709-4b5d-4711-aec0-9a8a9ba7b886">
        <File Id="src_pepXML.dll" Name="pepXML.dll" Source="$(var.GUI_TargetDir)pepXML.dll" />
      </Component>
      <Component Id="src_Proteomics.dll" Guid="e0bd6f66-afa5-49fa-a17c-2a24164f600d">
        <File Id="src_Proteomics.dll" Name="Proteomics.dll" Source="$(var.GUI_TargetDir)Proteomics.dll" />
      </Component>
      <Component Id="src_SharpLearning.Common.Interfaces.dll" Guid="62b8e7de-7965-4942-9e5b-9449c5ab7deb">
        <File Id="src_SharpLearning.Common.Interfaces.dll" Name="SharpLearning.Common.Interfaces.dll" Source="$(var.GUI_TargetDir)SharpLearning.Common.Interfaces.dll" />
      </Component>
      <Component Id="src_SharpLearning.Containers.dll" Guid="6bdbf050-26d7-4e11-b378-d71055ecba80">
        <File Id="src_SharpLearning.Containers.dll" Name="SharpLearning.Containers.dll" Source="$(var.GUI_TargetDir)SharpLearning.Containers.dll" />
      </Component>
      <Component Id="src_SharpLearning.CrossValidation.dll" Guid="da2245c7-362d-4a90-9408-a671e210896a">
        <File Id="src_SharpLearning.CrossValidation.dll" Name="SharpLearning.CrossValidation.dll" Source="$(var.GUI_TargetDir)SharpLearning.CrossValidation.dll" />
      </Component>
      <Component Id="src_SharpLearning.DecisionTrees.dll" Guid="b3c202a8-795d-4198-b927-0fcd02d8ae05">
        <File Id="src_SharpLearning.DecisionTrees.dll" Name="SharpLearning.DecisionTrees.dll" Source="$(var.GUI_TargetDir)SharpLearning.DecisionTrees.dll" />
      </Component>
      <Component Id="src_SharpLearning.InputOutput.dll" Guid="357e6a45-5852-474d-aceb-e05942958ae6">
        <File Id="src_SharpLearning.InputOutput.dll" Name="SharpLearning.InputOutput.dll" Source="$(var.GUI_TargetDir)SharpLearning.InputOutput.dll" />
      </Component>
      <Component Id="src_SharpLearning.Metrics.dll" Guid="9ec3dd96-8228-49db-98e7-4288845b63a4">
        <File Id="src_SharpLearning.Metrics.dll" Name="SharpLearning.Metrics.dll" Source="$(var.GUI_TargetDir)SharpLearning.Metrics.dll" />
      </Component>
      <Component Id="src_SharpLearning.RandomForest.dll" Guid="f86fdc0c-6a23-4e4f-803b-0012aaa418e7">
        <File Id="src_SharpLearning.RandomForest.dll" Name="SharpLearning.RandomForest.dll" Source="$(var.GUI_TargetDir)SharpLearning.RandomForest.dll" />
      </Component>
      <Component Id="src_SharpLearning.Optimization.dll" Guid="3C9AC945-8AE8-4A81-AC1B-1BE7E6DF6DE0">
        <File Id="src_SharpLearning.Optimization.dll" Name="SharpLearning.Optimization.dll" Source="$(var.GUI_TargetDir)SharpLearning.Optimization.dll" />
      </Component>
      <Component Id="src_SharpLearning.GradientBoost.dll" Guid="F76D5154-5F85-4692-9A6B-B822EA1CB4DE">
        <File Id="src_SharpLearning.GradientBoost.dll" Name="SharpLearning.GradientBoost.dll" Source="$(var.GUI_TargetDir)SharpLearning.GradientBoost.dll" />
      </Component>
      <Component Id="src_Mgf.dll" Guid="B4EB5CEA-CFCA-40C7-A915-DB3B9EF53775">
        <File Id="src_Mgf.dll" Name="Mgf.dll" Source="$(var.GUI_TargetDir)Mgf.dll" />
      </Component>
      <Component Id="src_OxyPlot.dll" Guid="1B25D408-13DB-4A9E-A49E-B0A7FC8C05A6">
        <File Id="src_OxyPlot.dll" Name="OxyPlot.dll" Source="$(var.GUI_TargetDir)OxyPlot.dll" />
      </Component>
      <Component Id="src_OxyPlot.Wpf.dll" Guid="2052508D-D83C-45D7-8C9C-9211F97A8949">
        <File Id="src_OxyPlot.Wpf.dll" Name="OxyPlot.Wpf.dll" Source="$(var.GUI_TargetDir)OxyPlot.Wpf.dll" />
      </Component>
      <Component Id="src_itext.barcodes.dll" Guid="4CC3D87C-FA1E-4301-B0B9-4E1EE3DFC4F2">
        <File Id="src_itext.barcodes.dll" Name="itext.barcodes.dll" Source="$(var.GUI_TargetDir)itext.barcodes.dll" />
      </Component>
      <Component Id="src_itext.forms.dll" Guid="F2265F92-F292-4158-B85B-632EE831716F">
        <File Id="src_itext.forms.dll" Name="itext.forms.dll" Source="$(var.GUI_TargetDir)itext.forms.dll" />
      </Component>
      <Component Id="src_itext.io.dll" Guid="C183440D-7817-4604-B08B-C32713FE6209">
        <File Id="src_itext.io.dll" Name="itext.io.dll" Source="$(var.GUI_TargetDir)itext.io.dll" />
      </Component>
      <Component Id="src_itext.kernel.dll" Guid="2EA91430-8520-44B3-A1CC-41B55802752F">
        <File Id="src_itext.kernel.dll" Name="itext.kernel.dll" Source="$(var.GUI_TargetDir)itext.kernel.dll" />
      </Component>
      <Component Id="src_itext.layout.dll" Guid="537A10C8-477B-4B1B-8D7F-24BCBBB9AB88">
        <File Id="src_itext.layout.dll" Name="itext.layout.dll" Source="$(var.GUI_TargetDir)itext.layout.dll" />
      </Component>
      <Component Id="src_itext.pdfa.dll" Guid="3C93C9EC-EB51-4D7D-9F71-DEE619442AF8">
        <File Id="src_itext.pdfa.dll" Name="itext.pdfa.dll" Source="$(var.GUI_TargetDir)itext.pdfa.dll" />
      </Component>
      <Component Id="src_itext.sign.dll" Guid="37F6B45B-B6C2-4E6B-9CBD-D3AFDCE3B45B">
        <File Id="src_itext.sign.dll" Name="itext.sign.dll" Source="$(var.GUI_TargetDir)itext.sign.dll" />
      </Component>
      <Component Id="src_itext.styledxmlparser.dll" Guid="105FCEC7-A05E-45CF-8F38-BFA5EFA0559B">
        <File Id="src_itext.styledxmlparser.dll" Name="itext.styledxmlparser.dll" Source="$(var.GUI_TargetDir)itext.styledxmlparser.dll" />
      </Component>
      <Component Id="src_itext.svg.dll" Guid="C49A6ADB-94DD-4223-B97E-884D60EABF82">
        <File Id="src_itext.svg.dll" Name="itext.svg.dll" Source="$(var.GUI_TargetDir)itext.svg.dll" />
      </Component>
      <Component Id="src_ThermoFisher.CommonCore.BackgroundSubtraction.dll" Guid="F3DA60DB-CF5F-4671-9F3C-1033780261DD">
        <File Id="src_ThermoFisher.CommonCore.BackgroundSubtraction.dll" Name="ThermoFisher.CommonCore.BackgroundSubtraction.dll" Source="$(var.GUI_TargetDir)ThermoFisher.CommonCore.BackgroundSubtraction.dll" />
      </Component>
      <Component Id="src_ThermoFisher.CommonCore.Data.dll" Guid="E711A739-AE5D-4DB9-9B14-0E4A8281CD20">
        <File Id="src_ThermoFisher.CommonCore.Data.dll" Name="ThermoFisher.CommonCore.Data.dll" Source="$(var.GUI_TargetDir)ThermoFisher.CommonCore.Data.dll" />
      </Component>
      <Component Id="src_ThermoFisher.CommonCore.MassPrecisionEstimator.dll" Guid="03803256-C0A9-4DE8-9923-574E4BA2DEBA">
        <File Id="src_ThermoFisher.CommonCore.MassPrecisionEstimator.dll" Name="ThermoFisher.CommonCore.MassPrecisionEstimator.dll" Source="$(var.GUI_TargetDir)ThermoFisher.CommonCore.MassPrecisionEstimator.dll" />
      </Component>
      <Component Id="src_ThermoFisher.CommonCore.RawFileReader.dll" Guid="F5EDAA70-06CD-49E7-932F-016C679B07C7">
        <File Id="src_ThermoFisher.CommonCore.RawFileReader.dll" Name="ThermoFisher.CommonCore.RawFileReader.dll" Source="$(var.GUI_TargetDir)ThermoFisher.CommonCore.RawFileReader.dll" />
      </Component>
      <Component Id="src_ThermoRawFileReader.dll" Guid="4BE9A662-4CD1-4E5B-8234-0734036A007E">
        <File Id="src_ThermoRawFileReader.dll" Name="ThermoRawFileReader.dll" Source="$(var.GUI_TargetDir)ThermoRawFileReader.dll" />
      </Component>
      <Component Id="src_BayesianEstimation.dll" Guid="100F4A2E-F4FE-4D25-8C5F-66A7092A2622">
        <File Id="src_BayesianEstimation.dll" Name="BayesianEstimation.dll" Source="$(var.GUI_TargetDir)BayesianEstimation.dll" />
      </Component>
      <Component Id="src_Microsoft.ML.Core.dll" Guid="A5B34A93-481B-4B6A-868C-A0DB916CB37C">
        <File Id="src_Microsoft.ML.Core.dll" Name="Microsoft.ML.Core.dll" Source="$(var.GUI_TargetDir)Microsoft.ML.Core.dll" />
      </Component>
      <Component Id="src_Microsoft.ML.CpuMath.dll" Guid="5D8DCF19-98EB-4EF8-B4FF-4B039FB5CE95">
        <File Id="src_Microsoft.ML.CpuMath.dll" Name="Microsoft.ML.CpuMath.dll" Source="$(var.GUI_TargetDir)Microsoft.ML.CpuMath.dll" />
      </Component>
      <Component Id="src_Microsoft.ML.Data.dll" Guid="EF66B298-ED51-4B60-8E9F-1383E9FBA452">
        <File Id="src_Microsoft.ML.Data.dll" Name="Microsoft.ML.Data.dll" Source="$(var.GUI_TargetDir)Microsoft.ML.Data.dll" />
      </Component>
      <Component Id="src_Microsoft.ML.DataView.dll" Guid="E87F47EB-394F-42C3-AFA5-5AEC61E80AE5">
        <File Id="src_Microsoft.ML.DataView.dll" Name="Microsoft.ML.DataView.dll" Source="$(var.GUI_TargetDir)Microsoft.ML.DataView.dll" />
      </Component>
      <Component Id="src_Microsoft.ML.FastTree.dll" Guid="5E607343-B503-4798-A2D0-D3798E3C553A">
        <File Id="src_Microsoft.ML.FastTree.dll" Name="Microsoft.ML.FastTree.dll" Source="$(var.GUI_TargetDir)Microsoft.ML.FastTree.dll" />
      </Component>
      <Component Id="src_Microsoft.ML.KMeansClustering.dll" Guid="830AE3D1-78E3-4C19-90D1-E489FA89AD91">
        <File Id="src_Microsoft.ML.KMeansClustering.dll" Name="Microsoft.ML.KMeansClustering.dll" Source="$(var.GUI_TargetDir)Microsoft.ML.KMeansClustering.dll" />
      </Component>
      <Component Id="src_Microsoft.ML.PCA.dll" Guid="05B84885-9772-4329-B7DC-C53D5CD2ED17">
        <File Id="src_Microsoft.ML.PCA.dll" Name="Microsoft.ML.PCA.dll" Source="$(var.GUI_TargetDir)Microsoft.ML.PCA.dll" />
      </Component>
      <Component Id="src_Microsoft.ML.StandardTrainers.dll" Guid="833E5791-A057-40BC-8208-DEE757A9B873">
        <File Id="src_Microsoft.ML.StandardTrainers.dll" Name="Microsoft.ML.StandardTrainers.dll" Source="$(var.GUI_TargetDir)Microsoft.ML.StandardTrainers.dll" />
      </Component>
      <Component Id="src_Microsoft.ML.Transforms.dll" Guid="9FF08BC2-8F99-4004-A4F0-3BB63014BB21">
        <File Id="src_Microsoft.ML.Transforms.dll" Name="Microsoft.ML.Transforms.dll" Source="$(var.GUI_TargetDir)Microsoft.ML.Transforms.dll" />
      </Component>
      <Component Id="src_MarkdownSharp.dll" Guid="5F6FD76A-5674-4E64-9727-1C97AD493FD5">
        <File Id="src_MarkdownSharp.dll" Name="MarkdownSharp.dll" Source="$(var.GUI_TargetDir)MarkdownSharp.dll" />
      </Component>
      <Component Id="src_Easy.Common.dll" Guid="0C0FD8E3-FC7D-40BB-B9A0-722FDAFBFADC">
        <File Id="src_Easy.Common.dll" Name="Easy.Common.dll" Source="$(var.GUI_TargetDir)Easy.Common.dll" />
      </Component>
      <Component Id="src_MetaMorpheusGUI.dll" Guid="7404E69C-BCA6-4E4C-87FB-80C552FFA522">
        <File Id="src_MetaMorpheusGUI.dll" Name="MetaMorpheusGUI.dll" Source="$(var.GUI_TargetDir)MetaMorpheusGUI.dll" />
      </Component>
      <Component Id="src_OpenMcdf.dll" Guid="B984BD4D-6FC1-4A1F-8AE6-5688BA2A631A">
        <File Id="src_OpenMcdf.dll" Name="OpenMcdf.dll" Source="$(var.GUI_TargetDir)OpenMcdf.dll" />
      </Component>
      <Component Id="src_OpenMcdf.Extensions.dll" Guid="69004206-94FD-4342-A98D-70560B41C7B3">
        <File Id="src_OpenMcdf.Extensions.dll" Name="OpenMcdf.Extensions.dll" Source="$(var.GUI_TargetDir)OpenMcdf.Extensions.dll" />
      </Component>
      <Component Id="src_MetaMorpheusGUI.deps.json" Guid="B5A6A934-76F0-407D-85D9-9DA45109B815">
        <File Id="src_MetaMorpheusGUI.deps.json" Name="MetaMorpheusGUI.deps.json" Source="$(var.GUI_TargetDir)MetaMorpheusGUI.deps.json" />
      </Component>
      <Component Id="src_MetaMorpheusGUI.runtimeconfig.dev.json" Guid="0B43BC71-A8C3-4911-8911-2DB999F49DF5">
        <File Id="src_MetaMorpheusGUI.runtimeconfig.dev.json" Name="MetaMorpheusGUI.runtimeconfig.dev.json" Source="$(var.GUI_TargetDir)MetaMorpheusGUI.runtimeconfig.dev.json" />
      </Component>
      <Component Id="src_MetaMorpheusGUI.runtimeconfig.json" Guid="74373586-8FF6-4E06-9108-7648B8590005">
        <File Id="src_MetaMorpheusGUI.runtimeconfig.json" Name="MetaMorpheusGUI.runtimeconfig.json" Source="$(var.GUI_TargetDir)MetaMorpheusGUI.runtimeconfig.json" />
      </Component>

      <!--Command-Line Components-->
      <Component Id="src_CMD.deps.json" Guid="92190CCF-0138-4F0B-9356-02C914D5A439">
        <File Id="src_CMD.deps.json" Name="CMD.deps.json" Source="$(var.CMD_TargetDir)CMD.deps.json" />
      </Component>
      <Component Id="src_CMD.dll" Guid="310D5E4E-7EF9-4B1B-96FD-FFE49481BB5E">
        <File Id="src_CMD.dll" Name="CMD.dll" Source="$(var.CMD_TargetDir)CMD.dll" />
      </Component>
      <Component Id="src_CMD.dll.config" Guid="036C0999-0D44-4F6C-9F80-52E85DAC2698">
        <File Id="src_CMD.dll.config" Name="CMD.dll.config" Source="$(var.CMD_TargetDir)CMD.dll.config" />
      </Component>
      <Component Id="src_CMD.exe" Guid="42BD2CE2-0EB3-40DE-BCD5-D723CE081C22">
        <File Id="src_CMD.exe" Name="CMD.exe" Source="$(var.CMD_TargetDir)CMD.exe" />
      </Component>
      <Component Id="src_CMD.pdb" Guid="67AF7BA5-0D22-47B7-A67B-C54D5B6668C7">
        <File Id="src_CMD.pdb" Name="CMD.pdb" Source="$(var.CMD_TargetDir)CMD.pdb" />
      </Component>
      <Component Id="src_CMD.runtimeconfig.dev.json" Guid="DF119DAD-FFA0-4F2E-8302-759001E4F755">
        <File Id="src_CMD.runtimeconfig.dev.json" Name="CMD.runtimeconfig.dev.json" Source="$(var.CMD_TargetDir)CMD.runtimeconfig.dev.json" />
      </Component>
      <Component Id="src_CMD.runtimeconfig.json" Guid="EB901649-9102-4F1C-946E-C844383BECAE">
        <File Id="src_CMD.runtimeconfig.json" Name="CMD.runtimeconfig.json" Source="$(var.CMD_TargetDir)CMD.runtimeconfig.json" />
      </Component>
      <Component Id="src_CommandLine.dll" Guid="7B810D27-CAC0-41A8-90A2-D1594A678BC9">
        <File Id="src_CommandLine.dll" Name="CommandLine.dll" Source="$(var.CMD_TargetDir)CommandLine.dll" />
      </Component>
    </ComponentGroup>
    <ComponentGroup Id="ExecutablesAndLibrariesComponentGroup2" Directory="NativeMathDllFolder_native">
      <Component Id="src_CpuMathNative.dll" Guid="436C233C-5BCD-4386-90C7-F2AC489B09CF">
        <File Id="src_CpuMathNative.dll" Name="CpuMathNative.dll" Source="$(var.GUI_TargetDir)runtimes\win-x64\native\CpuMathNative.dll" />
      </Component>
      <Component Id="src_FastTreeNative.dll" Guid="EF4AB27C-25D6-4B30-B259-9671EC40042A">
        <File Id="src_FastTreeNative.dll" Name="FastTreeNative.dll" Source="$(var.GUI_TargetDir)runtimes\win-x64\native\FastTreeNative.dll" />
      </Component>
      <Component Id="src_LdaNative.dll" Guid="2FDBD232-12A0-43D6-A54D-06FFC627CE23">
        <File Id="src_LdaNative.dll" Name="LdaNative.dll" Source="$(var.GUI_TargetDir)runtimes\win-x64\native\LdaNative.dll" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <!--Build the App Mods folder-->
  <Fragment>
    <ComponentGroup Id="Appsrc_Mods_files" Directory="MetaAppModsFolder">
      <Component Id="RemoveMods" Guid="284c0784-2183-4f80-af61-56cadeb800bf">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RemoveFolder Id="MetaAppModsFolder" On="both" />
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <!-- aListOfmods.txt -->
      <Component Id="Appsrc_Mods_aListOfmods.txt" Guid="0aa9b5ed-b47d-4a78-93b1-49ebc104d011">
        <File ReadOnly="no" Id="Appsrc_Mods_aListOfmods.txt" Name="aListOfmods.txt" Source="$(var.GUI_TargetDir)Mods\aListOfmods.txt" />
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <!-- glyco.txt -->
      <Component Id="Appsrc_Mods_glyco.txt" Guid="1707b26b-070e-46d5-9632-f1bc8bf4d281">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Mods_glyco.txt" Name="glyco.txt" Source="$(var.GUI_TargetDir)Mods\glyco.txt" />
      </Component>

      <!-- Mods.txt -->
      <Component Id="Appsrc_Mods_Mods.txt" Guid="9be193e3-266c-4c1d-9973-341f0a5d108a">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Mods_Mods.txt" Name="Mods.txt" Source="$(var.GUI_TargetDir)Mods\Mods.txt" />
      </Component>

      <!-- substitutions.txt -->
      <Component Id="Appsrc_Mods_substitutions.txt" Guid="f108606b-f9eb-4c3c-893b-7ec33c88a1d1">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Mods_substitutions.txt" Name="substitutions.txt" Source="$(var.GUI_TargetDir)Mods\substitutions.txt" />
      </Component>

      <!-- surfactants.txt -->
      <Component Id="Appsrc_Mods_surfactants.txt" Guid="937d6734-a4c0-469a-b070-64bf5de84b13">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Mods_surfactants.txt" Name="surfactants.txt" Source="$(var.GUI_TargetDir)Mods\surfactants.txt" />
      </Component>

      <!-- tmt.txt -->
      <Component Id="Appsrc_Mods_tmt.txt" Guid="f064b7a0-c650-4a40-8a9f-301cc6cb946e">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Mods_tmt.txt" Name="tmt.txt" Source="$(var.GUI_TargetDir)Mods\tmt.txt" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <!--Build the Mods NGlycan folder-->
  <Fragment>
    <ComponentGroup Id="Appsrc_NGlycan_files" Directory="MetaAppNGlycanFolder">
      <Component Id="RemoveNGlycan" Guid="676F63E9-1942-444E-BDA1-FCFF732BF308">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RemoveFolder Id="MetaAppNGlycanFolder" On="both" />
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <Component Id="Appsrc_Data_NGlycan182.gdb" Guid="1AE1B223-9C67-4378-BA07-ABA31BCE4EAB">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_NGlycan182.gdb" Name="NGlycan182.gdb" Source="$(var.GUI_TargetDir)Glycan_Mods\NGlycan\NGlycan182.gdb" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <!--Build the Mods OGlycan folder-->
  <Fragment>
    <ComponentGroup Id="Appsrc_OGlycan_files" Directory="MetaAppOGlycanFolder">
      <Component Id="RemoveOGlycan" Guid="A9489498-459A-4D6A-9337-92BFE9347FBD">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RemoveFolder Id="MetaAppOGlycanFolder" On="both" />
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>

      <Component Id="Appsrc_Data_OGlycan.gdb" Guid="08054759-2D7E-4760-A174-A53E5A77507F">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_OGlycan.gdb" Name="OGlycan.gdb" Source="$(var.GUI_TargetDir)Glycan_Mods\OGlycan\OGlycan.gdb" />
      </Component>
      <Component Id="Appsrc_OlgycanDatabase28glycansplusSodium56total.txt" Guid="BCA7AE90-98BA-4F94-9A6A-0BB8486F5532">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_OlgycanDatabase28glycansplusSodium56total.txt" Name="Olgycan Database 28 glycans plus Sodium 56 total.txt" Source="$(var.GUI_TargetDir)Glycan_Mods\OGlycan\Olgycan Database 28 glycans plus Sodium 56 total.txt" />
      </Component>
      <Component Id="Appsrc_OlgycanDatabase28glycansplusSulfo56total.txt" Guid="FB4F3975-AC0E-4FFC-8FF1-D3925DF7E316">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_OlgycanDatabase28glycansplusSulfo56total.txt" Name="Olgycan Database 28 glycans plus Sulfo 56 total.txt" Source="$(var.GUI_TargetDir)Glycan_Mods\OGlycan\Olgycan Database 28 glycans plus Sulfo 56 total.txt" />
      </Component>
      <Component Id="Appsrc_OlgycanDatabase28glycans.txt" Guid="51746266-C4B9-42D5-AA13-0C07D57122DA">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_OlgycanDatabase28glycans.txt" Name="Olgycan Database 28 glycans.txt" Source="$(var.GUI_TargetDir)Glycan_Mods\OGlycan\Olgycan Database 28 glycans.txt" />
      </Component>
      <Component Id="Appsrc_OlgycanDatabase32glycans.txt" Guid="C25BAFAC-583B-4694-BF0A-D2694AE23DB6">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_OlgycanDatabase32glycans.txt" Name="Olgycan Database 32 glycans.txt" Source="$(var.GUI_TargetDir)Glycan_Mods\OGlycan\Olgycan Database 32 glycans.txt" />
      </Component>
      <Component Id="Appsrc_OlgycanDatabase36glycanswithMann.txt" Guid="F51F7BC6-6119-459B-ABB9-25408BA1930D">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_OlgycanDatabase36glycanswithMann.txt" Name="Olgycan Database 36 glycans with Mann.txt" Source="$(var.GUI_TargetDir)Glycan_Mods\OGlycan\Olgycan Database 36 glycans with Mann.txt" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <!--Builds the App Glycan_Mods folder-->
  <Fragment>
    <ComponentGroup Id="Appsrc_Glycan_Mods_files" Directory="MetaAppGlycan_ModsFolder">
      <Component Id="RemoveGlycanModsData" Guid="40090707-AEFF-4C5C-9693-F9A11F9D0402">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RemoveFolder Id="MetaAppGlycan_ModsFolder" On="both" />
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>      
    </ComponentGroup>
  </Fragment>



  <!--Builds the App Data folder-->
  <Fragment>
    <ComponentGroup Id="Appsrc_Data_files" Directory="MetaAppDataFolder">
      <Component Id="RemoveData" Guid="80dd5110-5563-499a-93ee-652e351c64f9">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RemoveFolder Id="MetaAppDataFolder" On="both" />
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>
      <Component Id="Appsrc_Data_combos.txt" Guid="e16d25a3-d773-4a7f-9252-63d737c2c7ba">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Data_combos.txt" Name="combos.txt" Source="$(var.GUI_TargetDir)Data\combos.txt" />
      </Component>
      <Component Id="Appsrc_Data_PSI_MOD.obo.xml" Guid="348109bd-4645-448e-b272-19a126e4c3cf">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Data_PSI_MOD.obo.xml" Name="PSI-MOD.obo.xml" Source="$(var.GUI_TargetDir)Data\PSI-MOD.obo.xml" />
      </Component>
      <Component Id="Appsrc_Data_ptmlist.txt" Guid="ea6237f4-9acd-4660-a4e8-831b7aab8c39">
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <Condition>OVERWRITEAPPDATA</Condition>
        <File ReadOnly="no" Id="Appsrc_Data_ptmlist.txt" Name="ptmlist.txt" Source="$(var.GUI_TargetDir)Data\ptmlist.txt" />
      </Component>
      <Component Id="Appsrc_Data_unimod.xml" Guid="cb7b6d9e-3eb0-47ac-857f-7a0009d95619">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Data_unimod.xml" Name="unimod.xml" Source="$(var.GUI_TargetDir)Data\unimod.xml" />
      </Component>
      <Component Id="Appsrc_Data_elements.dat" Guid="5ba496cc-8b84-4d25-a410-b2274718ebf9">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Data_elements.dat" Name="elements.dat" Source="$(var.GUI_TargetDir)Data\elements.dat" />
      </Component>
      <Component Id="Appsrc_Data_Crosslinkers.tsv" Guid="9F0C2C0A-FF6E-4714-BEF3-3E739B6573D2">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Crosslinkers.tsv" Name="Crosslinkers.tsv" Source="$(var.GUI_TargetDir)Data\Crosslinkers.tsv" />
      </Component>

      <Component Id="Appsrc_Data_SmallCalibratible_Yeast.mzML" Guid="8CA11AAC-0D36-4E99-BD37-E119003270FA">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_SmallCalibratible_Yeast.mzML" Name="SmallCalibratible_Yeast.mzML" Source="$(var.GUI_TargetDir)Data\SmallCalibratible_Yeast.mzML" />
      </Component>
      <Component Id="Appsrc_Data_SmallYeast.fasta" Guid="E8447600-B6AE-49BF-9130-340A604DFA70">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_SmallYeast.fasta" Name="SmallYeast.fasta" Source="$(var.GUI_TargetDir)Data\SmallYeast.fasta" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <!--Builds the App ProteolyticDigestion folder-->
  <Fragment>
    <ComponentGroup Id="Appsrc_ProteolyticDigestion_files" Directory="MetaAppProteolyticDigestionFolder">
      <Component Id="RemoveProteolyticDigestion">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RemoveFolder Id="MetaAppProteolyticDigestionFolder" On="both" />
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>
      <Component Id="Appsrc_ProteolyticDigestion_proteases.tsv" Guid="A3AF0FEB-59EE-4207-9BDB-3B285D1E720E">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_ProteolyticDigestion_proteases.tsv" Name="proteases.tsv" Source="$(var.GUI_TargetDir)ProteolyticDigestion\proteases.tsv" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <!--Builds the App Contaminants folder-->
  <Fragment>
    <ComponentGroup Id="Appsrc_Contaminants_files" Directory="MetaAppContaminantsFolder">
      <Component Id="RemoveContaminants" Guid="D40C37B7-1F04-4DCC-A4AC-46D9F613570A">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RemoveFolder Id="MetaAppContaminantsFolder" On="both" />
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      </Component>
      <Component Id="Appsrc_Contaminants_MetaMorpheus_Contaminants.xml" Guid="d840b7a1-dfce-418a-bd4a-f3805625f53d">
        <Condition>OVERWRITEAPPDATA</Condition>
        <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
        <File ReadOnly="no" Id="Appsrc_Contaminants_MetaMorpheusContaminants.xml" Name="MetaMorpheusContaminants.xml" Source="$(var.GUI_TargetDir)Contaminants\MetaMorpheusContaminants.xml" />
      </Component>
    </ComponentGroup>
  </Fragment>

  <Fragment>
    <ComponentGroup Id="ExcelDefaults">
      <Component Id ="ExcelDefault" Directory="ProgramFiles64Folder" Guid="{D6A1CF31-27C8-4DCB-A92F-D36D6EDB7C70}" Permanent="yes">
        <Condition> EXCELDEFAULTPROPERTY</Condition>
        <RemoveRegistryKey Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tsv" />
        <RegistryKey Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tsv\OpenWithList">
          <RegistryValue Name="a" Value="EXCEL.EXE" Type="string" />
          <RegistryValue Name="MRUList" Value="a" Type="string" />
        </RegistryKey>
        <RegistryKey Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.tsv\OpenWithProgids">
          <RegistryValue Name="tsv_auto_file" Value="0000" Type="binary" />
        </RegistryKey>
        <RemoveRegistryKey Action="removeOnInstall" Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.psmtsv" />
        <RegistryKey Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.psmtsv\OpenWithList">
          <RegistryValue Name="a" Value="EXCEL.EXE" Type="string" />
          <RegistryValue Name="MRUList" Value="a" Type="string" />
        </RegistryKey>
        <RegistryKey Root="HKCU" Key="Software\Microsoft\Windows\CurrentVersion\Explorer\FileExts\.psmtsv\OpenWithProgids">
          <RegistryValue Name="psmtsv_auto_file" Value="0000" Type="binary" />
        </RegistryKey>
      </Component>
      <Component Id ="ExcelDefault2" Directory="ProgramFiles64Folder" Guid="{A19A382C-8DD8-4A03-8DE8-66973C197A98}" Permanent="yes">
        <Condition><![CDATA[EXCELSELECT<>"1"]]> </Condition>
        <RemoveRegistryKey Action="removeOnInstall" Root="HKCU" Key="Software\Classes\tsv_auto_file\shell\open\command" />
        <RegistryKey Root="HKCU" Key="Software\Classes\tsv_auto_file\shell\open\command">
          <RegistryValue Action="write" Value="&quot;[EXCELSELECT]&quot; &quot;%1&quot;" Type="string" />
        </RegistryKey>
        <RemoveRegistryKey Action="removeOnInstall" Root="HKCU" Key="Software\Classes\psmtsv_auto_file\shell\open\command" />
        <RegistryKey Root="HKCU" Key="Software\Classes\psmtsv_auto_file\shell\open\command">
          <RegistryValue Action="write" Value="&quot;[EXCELSELECT]&quot; &quot;%1&quot;" Type="string" />
        </RegistryKey>
      </Component>
    </ComponentGroup>
  </Fragment>

  <!--MetaMorpheus Program Menu Folder and Registry Key-->
  <Fragment>
    <Component Id="MetaMorpheusProgramMenuFolderComponent" Directory="MetaMorpheusProgramMenuFolder" Guid="c68bc3b0-cc4f-48ed-9ea0-25dbd7492292">
      <RegistryValue Root="HKCU" Key="Software\SmithGroup\MetaMorpheus" Name="installed" Type="integer" Value="1" KeyPath="yes" />
      <Shortcut Id="AppStartMenuSC"
                Name="MetaMorpheus"
                Description="Shortcut to App"
                Target="[#MetaMorpheusGUI.exe]"
                WorkingDirectory="MetaMorpheusInstallFolder" />
      <Shortcut Id="UninstallProduct"
                Name="Uninstall MetaMorpheus"
                Description="Uninstalls My Application"
                Target="[System64Folder]msiexec.exe"
                Arguments="/x [ProductCode]" />
      <RemoveFolder Id="MetaMorpheusProgramMenuFolder" On="both" />
    </Component>
  </Fragment>
</Wix>